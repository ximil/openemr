<?php 
/* +-----------------------------------------------------------------------------+
*    OpenEMR - Open Source Electronic Medical Record
*    Copyright (C) 2014 Z&H Consultancy Services Private Limited <sam@zhservices.com>
*
*    This program is free software: you can redistribute it and/or modify
*    it under the terms of the GNU Affero General Public License as
*    published by the Free Software Foundation, either version 3 of the
*    License, or (at your option) any later version.
*
*    This program is distributed in the hope that it will be useful,
*    but WITHOUT ANY WARRANTY; without even the implied warranty of
*    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*    GNU Affero General Public License for more details.
*
*    You should have received a copy of the GNU Affero General Public License
*    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*
*    @author  Chandni Babu <chandnib@zhservices.com>  
* +------------------------------------------------------------------------------+
*/

$patient_data = array(
	'sex'         => 'Sex',
	'pubpid'      => 'External ID',
	'street'      => 'Street',
	'city'        => 'City',
	'state'       => 'State',
	'postal_code' => 'Postal Code',
  'country_code'=> 'Country',
  'phone_home'  => 'Phone',
  'status'      => 'Marital Status',
  'religion'    => 'Religion',
  'race'        => 'Race',
  'ethnicity'   => 'Ethnicity'  
);

$date_format = \Application\Model\ApplicationTable::dateFormat('dd/mm/yyyy');

?>
<style type="text/css">
  .demo_old{
    color       :red;
    padding-left:25px;
  }
  select, textarea, input[type="text"], input[type="password"], input[type="datetime"], input[type="datetime-local"], input[type="date"], input[type="month"], input[type="time"], input[type="week"], input[type="number"], input[type="email"], input[type="url"], input[type="search"], input[type="tel"], input[type="color"], .uneditable-input{
    margin: 0px;
    width: 100px !important;
  }
</style>
<script type="text/javascript">
  function submit_form(setval)
  {
    document.getElementById('setval').value = setval; 
  }
  function setProcedureNameHidden(procedure_name,ij)
  { 
    $(".procedure_result-proc_name-"+ij).val(procedure_name);
  }
</script>
<form method="post" action="<?php echo $this->basePath() . '/carecoordination/revandapprove';?>">
  <input type="hidden" name="amid" value="<?php echo $this->amid;?>">
  <input type="hidden" name="pid" value="<?php echo $this->pid;?>">
  <input type="hidden" name="document_id" id="document_id" value="<?php echo $this->document_id; ?>" >
  <input type="hidden" name="setval" id="setval">
  <div class="body_inner_wrapper">
    <div class="header_wrap">
        <a style="text-decoration: none; position: absolute; top: 25px; left: 20px;" href="<?php echo $this->basePath();?>/carecoordination/upload" title="Go Back">
            <img style="height:20px; cursor: pointer;" src="<?php echo $this->basePath();?>/css/icons/go_back.png">
        </a>
        <input type="submit" class="search_button" value="Approve" onclick="submit_form('approve');" style="position: absolute; left: 45%;top: 25px;">
        <input type="submit" class="search_button" value="Discard" onclick="submit_form('discard');" style="position: absolute; left: 52%;top: 25px;">
    </div>
    <div class="clear"></div>

      <!--<div id="dragandrophandler">Drag & Drop Files Here</div><br/>-->
    <div id="status1"></div>

    <div class="clear"></div>
    <div class="se_in_8">
      <table class="responsive">
        <tr class="se_in_9">
            <th colspan="7"><?php echo $this->listenerObject->z_xlt('Demographics'); ?></th>
        </tr>
        <?php
        $i = 0;
        foreach($this->demographics as $row_dem){ 
          if($row_dem['field_name'] != 'lname' && $row_dem['field_name'] != 'fname' && $row_dem['field_name'] != 'DOB'){
            $i++;
            if($row_dem['field_name'] == 'sex'){ 
                ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->gender_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                  <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
                <?php
            }
            else if($row_dem['field_name'] == 'country_code'){ ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->country_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                   <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
              <?php
            }
            else if($row_dem['field_name'] == 'status'){ ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->marital_status_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                   <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
              <?php
            }
            else if($row_dem['field_name'] == 'religion'){ ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->religion_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                   <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
              <?php
            }
            else if($row_dem['field_name'] == 'race'){ ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->race_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                   <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
              <?php
            }
            else if($row_dem['field_name'] == 'ethnicity'){ ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>">
                  <?php foreach ($this->ethnicity_list as $value) { ?>
                    <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $this->listenerObject->z_xlt($value['label']);?></option>
                   <?php }?>
                </select>
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
              <?php
            }
            else{
                ?>
              <td><?php echo $this->listenerObject->z_xlt($patient_data[$row_dem['field_name']]);?></td>
              <td nowrap>
                <input name="<?php echo $row_dem['table_name']."-".$row_dem['field_name'];?>" type="text" value="<?php echo $this->listenerObject->z_xlt(htmlspecialchars($row_dem['field_value'], ENT_QUOTES));?>" style="width: 150px;">
                <span class="demo_old"><?php echo $this->listenerObject->z_xlt($this->demographics_old[0][$row_dem['field_name']]);?></span>
              </td>
              <td>
                <select name="<?php echo $row_dem['table_name']."-".$row_dem['field_name']."-sel";?>">
                  <option value="ignore"><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value="update"><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                </select>
              </td>
                <?php
            }
            if($i%2 == 0){
              if($i%4 == 2){
                  ?>
                  </tr><tr class='alternate'>
                  <?php
              }
              else{
                  ?>
                  </tr><tr>
                  <?php
              }
            }
            else{
                ?>
              <td></td>
                <?php
            }
          }
        }
      ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Social History'); ?></th>
        </tr>
        <?php
        foreach($this->social_history as $res_existing_social_history){  
          $arr_his_alcohol = explode("|",$res_existing_social_history['alcohol']);
          $arr_his_tobacco = explode("|",$res_existing_social_history['tobacco']);
          $alc1 = explode("alcohol",$arr_his_alcohol[1]);
          $tob1 = explode('tobacco',$arr_his_tobacco[1]);
          if($arr_his_alcohol[2] != 0 && $arr_his_alcohol[2] != '')
            $date_alcohol = $arr_his_alcohol[2];
          if($arr_his_tobacco[2] != 0 && $arr_his_tobacco[2] != '')
            $date_tobacco = $arr_his_tobacco[2];
              ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Alcohol'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt(ucfirst($arr_his_alcohol[0]));?></td>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt(ucfirst($alc1[0]));?></td>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php if($date_alcohol) echo \Application\Model\ApplicationTable::fixDate($date_alcohol, $date_format, 'yyyy-mm-dd');?>

          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Tobacco'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt(ucfirst($arr_his_tobacco[0]));?></td>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt(ucfirst($tob1[0]));?></td>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php if($date_tobacco) echo \Application\Model\ApplicationTable::fixDate($date_tobacco, $date_format, 'yyyy-mm-dd');?>

          </tr>
              <?php
        }
        $tobacco_status = array(
          '449868002'       => 'Current'	,
          '8517006'         => 'Quit' ,
          '266919005'       => 'Never' 
        );
        $alcohol_status = array(
          '219006'          => 'Current',
          '82581004'        => 'Quit',
          '228274009'       => 'Never'  
        );
        foreach($this->social_history_audit['social_history'] as $key => $val){
          $array_his_alcohol = explode("|",$val['alcohol']);
          if($array_his_alcohol[2] !=0 && $array_his_alcohol[2] != '') {
            $his_alc_date = \Carecoordination\Model\CarecoordinationTable::formatDate($array_his_alcohol[2],0);
          }
          $array_his_tobacco = explode("|",$val['smoking']);
          if($array_his_tobacco[2] !=0 && $array_his_tobacco[2] != '') {
            $his_tob_date = \Carecoordination\Model\CarecoordinationTable::formatDate($array_his_tobacco[2],0);
          }
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Alcohol'); ?></td>
            <td><input type='text' name='social_history-alcohol_note[]' value='<?php echo $this->listenerObject->z_xlt(ucfirst($array_his_alcohol[0])); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td>
              <?php foreach($alcohol_status as $key=>$value) {?>
                <input type='radio' name='social_history-alcohol_status[]' value='<?php echo strtolower($value)."alcohol"; ?>' <?php if($key== $array_his_alcohol[1]) echo "checked";?>><?php echo $this->listenerObject->z_xlt($value);?>
              <?php } ?>
            </td>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='social_history-alcohol_date[]' value='<?php if($his_alc_date) echo $his_alc_date; ?>' ></td>
            <td rowspan="2">
              <select name='social_history-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Tobacco'); ?></td>
            <td><input type='text' name='social_history-tobacco_note[]' value='<?php echo $this->listenerObject->z_xlt(ucfirst($array_his_tobacco[0])); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td>
              <?php foreach($tobacco_status as $key=>$value) {?>
                <input type='radio' name='social_history-tobacco_status[]' value='<?php echo strtolower($value)."tobacco"; ?>' <?php if($key== $array_his_tobacco[1]) echo "checked";?>><?php echo $this->listenerObject->z_xlt($value);?>
              <?php } ?>
            </td>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='social_history-tobacco_date[]' value='<?php if($his_tob_date) echo $his_tob_date; ?>' ></td>
          </tr>
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Encounter'); ?></th>
        </tr>
        <?php
        foreach($this->encounter as $res_existing_encounter){ 
          if($res_existing_encounter['date'] != 0 && $res_existing_encounter['date'] != '')
            $date_encounter = $res_existing_encounter['date'];
            ?>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php if($date_encounter) echo \Application\Model\ApplicationTable::fixDate($date_encounter, $date_format, 'yyyy-mm-dd');?></td>
            <td><?php echo $this->listenerObject->z_xlt('Provider'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($res_existing_encounter['provider_name']); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Facility'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($res_existing_encounter['facility']); ?></td>
            <td>&nbsp;</td>
          </tr>
            <?php
        }
        foreach($this->encounter_audit['encounter'] as $key => $val){
          if($val['date'] != 0 && $val['date'] != '') {
            $enc_xml_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val['date'],0);
          }
            ?>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='encounter-date[]' value='<?php if($enc_xml_date) echo $enc_xml_date;?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Provider'); ?></td>
            <td><input type='text' name='encounter-provider[]' value='<?php echo $this->listenerObject->z_xlt($val['provider_name']); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Facility'); ?></td>
            <td><input type='text' name='encounter-facility[]' value='<?php echo $this->listenerObject->z_xlt($val['represented_organization_name']); ?>' ></td>
            <td>
              <select name='encounter-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
            <input type="hidden" name="encounter-extension[]" value="<?php echo $val['extension'];?>">
            <input type="hidden" name="encounter-provider_npi[]" value="<?php echo $val['provider_npi'];?>">
            <input type="hidden" name="encounter-provider_address[]" value="<?php echo $val['provider_address'];?>">
            <input type="hidden" name="encounter-provider_city[]" value="<?php echo $val['provider_city'];?>">
            <input type="hidden" name="encounter-provider_state[]" value="<?php echo $val['provider_state'];?>">
            <input type="hidden" name="encounter-provider_postalCode[]" value="<?php echo $val['provider_postalCode'];?>">
            <input type="hidden" name="encounter-represented_organization_telecom[]" value="<?php echo $val['represented_organization_telecom'];?>">
          </tr>
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Problems'); ?></th>
        </tr>
        <?php
        foreach($this->problems as $res_existing_prob){ 
          if($res_existing_prob['activity'] == 1){
              $activity = 'Active';
          }
          else{
              $activity = 'Inactive';
          }
          
          if($res_existing_prob['enddate'] != NULL && $res_existing_prob['enddate'] != 0) {
            $end_date = \Application\Model\ApplicationTable::fixDate($res_existing_prob['enddate'], $date_format, 'yyyy-mm-dd');
          }
          if($res_existing_prob['begdate'] != NULL && $res_existing_prob['begdate'] != 0) {
            $beg_date = \Application\Model\ApplicationTable::fixDate($res_existing_prob['begdate'], $date_format, 'yyyy-mm-dd');
          }
          $set = 0;
          $cnt = 0;
          foreach($this->problems_audit['lists1'] as $k => $v){ 
            $cnt++;
            if($cnt%2 == 0){
                $class = 'alternate';
            }
            else{
                $class = '';
            }
            if(in_array($res_existing_prob['diagnosis'], $this->problems_audit['lists1'][$k])){
              $set = 1;
              ?>
              <tr class='<?php echo $class;?>' style="border-bottom: 0px">
                <td><?php echo $this->listenerObject->z_xlt('Title');?></td>
                <td><input type='text' name='lists1-upd_title[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($this->problems_audit['lists1'][$k]['list_code_text'], ENT_QUOTES));?>' ></td>
                <td><?php echo $this->listenerObject->z_xlt('Code'); ?></td>
                <td>
                    <input type='text' name='lists1-upd_diagnosis[]' value='<?php echo $this->listenerObject->z_xlt('SNOMED').': '.htmlspecialchars($this->problems_audit['lists1'][$k]['list_code'], ENT_QUOTES);?>' >
                    <input type='hidden' name='lists1-old-diagnosis[]' value='<?php echo htmlspecialchars($res_existing_prob['diagnosis'], ENT_QUOTES);?>' >
                </td>
                <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
                <td><input type='text' name='lists1-upd_activity[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($this->problems_audit['lists1'][$k]['status'], ENT_QUOTES));?>' ></td>
                <td rowspan="2">
                  <select name='lists1-upd-sel[]'>
                    <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                    <option value='update' ><?php echo $this->listenerObject->z_xlt('Update'); ?></option>
                  </select>
                </td>
              </tr>
              <tr style='color:red' >
                <td>&nbsp;</td>
                <td><?php echo $this->listenerObject->z_xlt($res_existing_prob['title']);?></td>
                <td>&nbsp;</td>
                <td><?php echo $this->listenerObject->z_xlt($res_existing_prob['diagnosis']);?></td>
                <td>&nbsp;</td>
                <td><?php echo $this->listenerObject->z_xlt($activity);?></td>
              </tr>
              <?php
              unset($this->problems_audit['lists1'][$k]);
            }
          }
          if($set == 0){                        
            ?>
            <tr style='border-bottom: 0px'>
              <td><?php echo $this->listenerObject->z_xlt('Title');?></td>
              <td><?php echo $this->listenerObject->z_xlt($res_existing_prob['title']);?></td>
              <td><?php echo $this->listenerObject->z_xlt('Begin Date');?></td>
              <td><?php if($beg_date) echo $beg_date;?></td>
              <td><?php echo $this->listenerObject->z_xlt('Code');?></td>
              <td><?php echo $this->listenerObject->z_xlt($res_existing_prob['diagnosis']);?></td>
              <td><?php echo $this->listenerObject->z_xlt('Status');?></td>
              <td><?php echo $this->listenerObject->z_xlt($activity);?></td>
              <td rowspan='2'>&nbsp;</td>
            </tr>
            <tr>
              <td><?php echo $this->listenerObject->z_xlt('End Date');?></td>
              <td><?php if($end_date) echo $end_date; ?></td>
            </tr>
            <?php
          }
        }
        foreach($this->problems_audit['lists1'] as $key => $val){ 
          if($val['status'] == 'Active'){
              $activity = 'Active';
          }
          else{
              $activity = 'Inactive';
          }
          if($val['enddate'] != 0 && $val['enddate'] != '') {
            $problem_enddate = \Carecoordination\Model\CarecoordinationTable::formatDate($val['enddate'],0);
          }
          if($val['begdate'] != 0 && $val['begdate'] != '') {
            $problem_begdate = \Carecoordination\Model\CarecoordinationTable::formatDate($val['begdate'],0);
          }
            ?>
          <tr style='border-bottom: 0px'>
            <td><?php echo $this->listenerObject->z_xlt('Title');?></td>
            <td><input type='text' name='lists1-title[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($val['list_code_text'], ENT_QUOTES));?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Begin Date');?></td>
            <td><input type='text' name='lists1-begdate[]' value='<?php if($problem_begdate) echo $problem_begdate;?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Code');?></td>
            <td><input type='text' name='lists1-diagnosis[]' value='<?php echo $this->listenerObject->z_xlt('SNOMED').": ".htmlspecialchars($val['list_code'], ENT_QUOTES);?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Status');?></td>
            <td><input type='text' name='lists1-activity[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($activity, ENT_QUOTES));?>' ></td>
            <td rowspan='2'>
              <select name='lists1-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore');?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert');?></option>
              </select>
            </td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('End Date');?></td>
            <td><input type='text' name='lists1-enddate[]' value='<?php if($problem_enddate) echo $problem_enddate;?>'></td>
            <input type="hidden" name="lists1-extension[]" value="<?php echo $val['extension'];?>">
          </tr>
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Allergy'); ?></th>
        </tr>
        <?php
        foreach($this->allergies as $res_existing_allergies){ 
          if($res_existing_allergies['activity'] == 1){
              $activity = 'Active';
          }
          else{
              $activity = 'Inactive';
          }
          if($res_existing_allergies['enddate'] != NULL && $res_existing_allergies['enddate'] != 0) {
            $end_date = \Application\Model\ApplicationTable::fixDate($res_existing_allergies['enddate'], $date_format, 'yyyy-mm-dd');
          }
          if($res_existing_allergies['begdate'] != NULL && $res_existing_allergies['begdate'] != 0) {
            $beg_date = \Application\Model\ApplicationTable::fixDate($res_existing_allergies['begdate'], $date_format, 'yyyy-mm-dd');
          }
          $severity = Carecoordination\Model\CarecoordinationTable::getListTitle($res_existing_allergies['severity_al'],'Severity',$res_existing_allergies['severity_al']);
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Title'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($res_existing_allergies['title']); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Begin Date'); ?></td>
            <td><?php if($beg_date) echo $beg_date;?></td>
            <td><?php echo $this->listenerObject->z_xlt('Diagnosis'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($res_existing_allergies['diagnosis']); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Severity'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($severity); ?></td>
            <td rowspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($activity); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('End Date'); ?></td> 
            <td><?php if($end_date) echo $end_date;?></td>
          </tr>
            <?php
        }
        foreach($this->allergies_audit['lists2'] as $key => $val){
          if($val['status'] == 'Active'){
              $activity = 'Active';
          }
          else{
              $activity = 'Inactive';
          }
          if($val['begdate'] != 0 && $val['begdate'] != '') {
            $allergy_begdate = \Carecoordination\Model\CarecoordinationTable::formatDate($val['begdate'],0);
          }
          
          if($val['enddate'] != 0 && $val['enddate'] != '') {
            $allergy_enddate = \Carecoordination\Model\CarecoordinationTable::formatDate($val['enddate'],0);
          }
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Title'); ?></td>
            <td><input type='text' name='lists2-title[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($val['list_code_text'], ENT_QUOTES)); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Begin Date'); ?></td>
            <td><input type='text' name='lists2-begdate[]' value='<?php if($allergy_begdate) echo $allergy_begdate;?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Diagnosis'); ?></td>
            <td><input type='text' name='lists2-diagnosis[]' value='<?php echo $this->listenerObject->z_xlt('SNOMED').": ".htmlspecialchars($val['list_code'], ENT_QUOTES); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Severity'); ?></td>
            <td><input type='text' name='lists2-severity_al[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($val['severity_al'], ENT_QUOTES)); ?>' ></td>
            <td rowspan="2">
              <select name='lists2-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore');?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert');?></option>
              </select>
            </td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Status'); ?></td>
            <td><input type='text' name='lists2-activity[]' value='<?php echo $this->listenerObject->z_xlt(htmlspecialchars($activity, ENT_QUOTES)); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('End Date'); ?></td> 
            <td><input type='text' name='lists2-enddate[]' value='<?php if($allergy_enddate) echo $allergy_enddate;?>'></td> 
            <input type="hidden" name="lists2-extension[]" value="<?php echo $val['extension'];?>">
          </tr>  
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Medications'); ?></th>
        </tr>
        <?php
        foreach($this->medications as $res_existing_medications){ 
          $units = \Carecoordination\Model\CarecoordinationTable::getListTitle($res_existing_medications['unit'],'drug_units','');
          $route = \Carecoordination\Model\CarecoordinationTable::getListTitle($res_existing_medications['route'],'drug_route','');
          if($res_existing_medications['date_added'] != 0 && $res_existing_medications['date_added'] != '')
            $date_added = $res_existing_medications['date_added'];
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php if($date_added) echo \Application\Model\ApplicationTable::fixDate($date_added, $date_format, 'yyyy-mm-dd');?></td>
            <td><?php echo $this->listenerObject->z_xlt('Name'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt($res_existing_medications['drug']);?></td>
            <td><?php echo $this->listenerObject->z_xlt('Dose'); ?></td>
            <td><?php echo $res_existing_medications['dosage']; ?></td>
            <td rowspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Strength'); ?></td>
            <td><?php echo $res_existing_medications['size'] ;?></td>
            <td><?php echo $this->listenerObject->z_xlt('Units'); ?></td>
            <td><?php echo $units;?></td>
            <td><?php echo $this->listenerObject->z_xlt('Route'); ?></td>
            <td><?php echo $route;?></td>
          </tr>
            <?php
        }
        foreach($this->medications_audit['lists3'] as $key => $val){    
          $route_option_id = \Carecoordination\Model\CarecoordinationTable::getOptionId('drug_route', $val['route_display']);
          $unit_option_id = \Carecoordination\Model\CarecoordinationTable::getOptionId('drug_units', $val['rate_unit']);
          $drug_unit_list   = \Application\Plugin\CommonPlugin::getList('drug_units',$unit_option_id,''); 
          $drug_route_list   = \Application\Plugin\CommonPlugin::getList('drug_route',$route_option_id,''); 
          if($val['begdate'] != 0 && $val['begdate'] != '')
            $beg_date = \Application\Model\ApplicationTable::fixDate($val['begdate'], $date_format, 'yyyy-mm-dd');
          ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='lists3-date_added[]' value='<?php if($beg_date) echo $beg_date;?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Name'); ?></td>
            <td><input type='text' name='lists3-drug[]' value='<?php echo $this->listenerObject->z_xlt($val['drug_text']); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Dose'); ?></td>
            <td><input type='text' name='lists3-dose[]' value='<?php echo htmlspecialchars($val['dose'], ENT_QUOTES); ?>' ></td>        
            <td rowspan="2">
              <select name='lists3-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
          </tr>
          <tr>           
            <td><?php echo $this->listenerObject->z_xlt('Strength'); ?></td>
            <td> <input style="width: 90px;" type='text' size='7' name='lists3-size[]' value='<?php echo htmlspecialchars($val['rate'], ENT_QUOTES); ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Units'); ?></td>
            <td> 
              <select name='lists3-units[]'>
                <?php foreach($drug_unit_list as $value) :?>
                  <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $value['label'];?></option>
                <?php endforeach; ?>
              </select>
            </td>
            <td><?php echo $this->listenerObject->z_xlt('Route'); ?></td>
            <td>
              <select name='lists3-route[]'>
                <?php foreach($drug_route_list as $value) :?>
                  <option value="<?php echo $value['value'];?>" <?php if($value['selected']==1) echo "selected";?>><?php echo $value['label'];?></option>
                <?php endforeach; ?>
              </select>
            </td>
            <input type="hidden" name="lists3-extension[]" value="<?php echo $val['extension'];?>">
            <input type="hidden" name="lists3-drugcode[]" value="<?php echo $val['drug_code'];?>">
            <input type="hidden" name="lists3-route_display[]" value="<?php echo $val['route_display'];?>">
            <input type="hidden" name="lists3-rate_unit[]" value="<?php echo $val['rate_unit'];?>">
            <input type="hidden" name="lists3-provider_npi[]" value="<?php echo $val['provider_npi'];?>">
            <input type="hidden" name="lists3-provider_name[]" value="<?php echo $val['provider_name'];?>">
            <input type="hidden" name="lists3-provider_address[]" value="<?php echo $val['provider_address'];?>">
            <input type="hidden" name="lists3-provider_city[]" value="<?php echo $val['provider_city'];?>">
            <input type="hidden" name="lists3-provider_state[]" value="<?php echo $val['provider_state'];?>">
            <input type="hidden" name="lists3-provider_postalCode[]" value="<?php echo $val['provider_postalCode'];?>">
            <input type="hidden" name="lists3-provider_telecom[]" value="<?php echo $val['provider_telecom'];?>">
          </tr>
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Immunization'); ?></th>
        </tr>
          <?php
        foreach($this->immunizations as $res_existing_immunizations){ 
          if($res_existing_immunizations['administered_date'] !=0 && $res_existing_immunizations['administered_date'] != '')
            $date_administered = $res_existing_immunizations['administered_date'];
            ?>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Administered Date'); ?></td>
            <td><?php if($date_administered) echo \Application\Model\ApplicationTable::fixDate($date_administered, $date_format, 'yyyy-mm-dd');?></td>
            <td><?php echo $this->listenerObject->z_xlt('Cvx Code'); ?></td>
            <td><?php echo $res_existing_immunizations['cvx_code']; ?></td>
            <td>&nbsp;</td>
          </tr>
            <?php
        }
        foreach($this->immunizations_audit['immunization']  as $key => $val){
          if($val['administered_date'] != 0 && $val['administered_date'] != '') {
            $immunization_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val['administered_date'],0);
          }
            ?>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('Administered Date'); ?></td>
            <td><input type='text' name='immunization-administered_date[]' value='<?php if($immunization_date) echo $immunization_date;?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Cvx Code'); ?></td>
            <td><input type='text' name='immunization-cvx_code[]' value='<?php echo $val['cvx_code']; ?>' ></td>
            <td>
              <select name='immunization-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
            <input type="hidden" name="immunization-extension[]" value="<?php echo $val['extension'];?>">
            <input type="hidden" name="immunization-provider_npi[]" value="<?php echo $val['provider_npi'];?>">
            <input type="hidden" name="immunization-provider_name[]" value="<?php echo $val['provider_name'];?>">
            <input type="hidden" name="immunization-provider_address[]" value="<?php echo $val['provider_address'];?>">
            <input type="hidden" name="immunization-provider_city[]" value="<?php echo $val['provider_city'];?>">
            <input type="hidden" name="immunization-provider_state[]" value="<?php echo $val['provider_state'];?>">
            <input type="hidden" name="immunization-provider_postalCode[]" value="<?php echo $val['provider_postalCode'];?>">
            <input type="hidden" name="immunization-represented_organization[]" value="<?php echo $val['represented_organization'];?>">
            <input type="hidden" name="immunization-represented_organization_tele[]" value="<?php echo $val['represented_organization_tele'];?>">
            <input type="hidden" name="immunization-provider_telecom[]" value="<?php echo $val['provider_telecom'];?>">
            <input type="hidden" name="immunization-rout_code_text[]" value="<?php echo $val['rout_code_text'];?>">
          </tr>
            <?php
        }
          ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Lab Results'); ?></th>
        </tr>
        <?php
          $arr_sub_lab_result = array();
          $exis_arr_sub_lab_result = array();
          $j=0;
          foreach($this->lab_results as $res_existing_lab_results){ 
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']]['order_title'] = $res_existing_lab_results['order_title'];
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']]['date_ordered'] = $res_existing_lab_results['date_ordered'];
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']][$res_existing_lab_results['result_id']]['result_desc']= $res_existing_lab_results['result_desc'];
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']][$res_existing_lab_results['result_id']]['result_value']= $res_existing_lab_results['result_value'];
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']][$res_existing_lab_results['result_id']]['units']= $res_existing_lab_results['units'];
            $exis_arr_sub_lab_result[$res_existing_lab_results['tcode']][$res_existing_lab_results['result_id']]['range']= $res_existing_lab_results['range'];
          }   
        ?>
        <tr style="border-top: 1px solid #CCCCCC;">
          <td><?php echo $this->listenerObject->z_xlt('Procedure Name'); ?></td>
          <td><?php echo $this->listenerObject->z_xlt('Date Ordered'); ?></td>
          <td><?php echo $this->listenerObject->z_xlt('Result'); ?></td>
          <td><?php echo $this->listenerObject->z_xlt('Value'); ?></td>
          <td><?php echo $this->listenerObject->z_xlt('Range'); ?></td>
          <td colspan="4">&nbsp;</td>
        </tr>
        <?php
          foreach($exis_arr_sub_lab_result as $key1 => $v1) { 
            $t=0;
            if($v1['date_ordered'] != 0 && $v1['date_ordered'] != '')
              $ordered_date = $v1['date_ordered'];
            foreach($v1 as $key2=>$value2) { 
              $t++; 
              ?> 
            <tr <?php if(count($v1)!= $t) { ?> style="border-bottom: 0px" <?php } ?>>
              <?php  if($t == 1) { ?>
              <td><?php echo $this->listenerObject->z_xlt($v1['order_title']); ?></td>
              <td><?php if($ordered_date) echo \Application\Model\ApplicationTable::fixDate($ordered_date, $date_format, 'yyyy-mm-dd');?></td>
              <?php  } else {?> 
              <td>&nbsp;</td> 
              <td>&nbsp;</td> 
                <?php  }
                if(is_array($value2)){
                ?>
              <td><?php echo $this->listenerObject->z_xlt($value2['result_desc']); ?></td>
              <td><?php echo $value2['result_value']." ".$this->layout()->plugin->z_xlt($value2['units']); ?></td>
              <td><?php echo $this->listenerObject->z_xlt($value2['range']); ?></td>
              <td colspan="4">&nbsp;</td> 
            </tr>
            <?php
             }
            }
           }
          foreach($this->lab_results_audit['procedure_result'] as $key => $val){ 
              $j= count($arr_sub_lab_result[$val['extension']]) + 1;
              $arr_sub_lab_result[$val['extension']]['proc_text'] = $val['proc_text'];
              $arr_sub_lab_result[$val['extension']]['date'] = $val['date'];
              $arr_sub_lab_result[$val['extension']]['proc_code'] = $val['proc_code'];
              $arr_sub_lab_result[$val['extension']]['proc_extension'] = $val['extension'];
              $arr_sub_lab_result[$val['extension']]['status'] = $val['status'];
              $arr_sub_lab_result[$val['extension']][$j]['results_date'] = $val['results_date'];
              $arr_sub_lab_result[$val['extension']][$j]['results_text'] = $val['results_text'];
              $arr_sub_lab_result[$val['extension']][$j]['results_value'] = $val['results_value'];
              $arr_sub_lab_result[$val['extension']][$j]['results_range'] = $val['results_range'];
              $arr_sub_lab_result[$val['extension']][$j]['results_code'] = $val['results_code'];
          }    
          ?>
            
          <tr style="border-bottom: 1px solid #CCCCCC; border-top: 1px solid #CCCCCC;">
            <td><?php echo $this->listenerObject->z_xlt('Procedure Name'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Date Ordered'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Result'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Value'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Range'); ?></td>
            <td colspan="4">&nbsp;</td>
          </tr>
          <?php 
          $ij = 0;
          foreach($arr_sub_lab_result as $k1=>$val1) { 
          $k =0;
          $ij++;
          if($val1['date'] !=0) {
            $result_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val1['date'],0);
          }
          foreach($val1 as $k2=>$val2) {
            $k++;
            if(is_array($val2) && $val2['results_date'] !=0 && $val2['results_date'] !='') {
              $proc_result_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val2['results_date'],0);
            }
          ?>
          <tr <?php if(count($val1)!= $k) { ?> style="border-bottom: 0px" <?php } ?>>
            <?php  if($k == 1) { ?>
            <td><input type='text'  name='procedure_result-name[]' value='<?php echo $this->listenerObject->z_xlt($val1['proc_text']); ?>' onblur="setProcedureNameHidden(this.value,'<?php echo $ij;?>');"></td>          
            <?php } else { ?>
            <td>&nbsp;</td>
            <?php }
            if(is_array($val2)) { 
              ?>
            <td><input type='text'  name='procedure_result-result_date[]' value='<?php if($proc_result_date) echo $proc_result_date;?>'></td>
            <td><input type='text' name='procedure_result-result[]' value='<?php echo $this->listenerObject->z_xlt($val2['results_text']); ?>' ></td>
            <td><input type='text' name='procedure_result-value[]' value='<?php echo $val2['results_value']; ?>' ></td>    
            <td><input type='text' name='procedure_result-range[]' value='<?php echo $this->listenerObject->z_xlt($val2['results_range']); ?>' ></td>
            <td colspan="4">
              <select name='procedure_result-sel[]'>
                <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
            <input type="hidden" name="procedure_result-proc_code[]" value="<?php echo $val1['proc_code'];?>">
            <input type="hidden" name="procedure_result-results_code[]" value="<?php echo $val2['results_code'];?>">
            <input type="hidden" class="procedure_result-proc_name-<?php echo $ij;?>" name="procedure_result-proc_name[]" value="<?php echo $val1['proc_text'];?>">
            <input type="hidden" name="procedure_result-proc_date[]" value="<?php if($result_date) echo $result_date;?>">
            <input type="hidden" name="procedure_result-proc_extension[]" value="<?php echo $val1['proc_extension'];?>">
            <input type="hidden" name="procedure_result-proc_status[]" value="<?php echo $val1['status'];?>">
          </tr>
          <?php
           }
          }
         }
         ?>
      </table>
      <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php echo $this->listenerObject->z_xlt('Vitals'); ?></th>
        </tr>
          <?php
        foreach($this->vitals as $res_existing_vitals){ 
          if($res_existing_vitals['date'] != 0 && $res_existing_vitals['date'] != '')
            $date_vitals = $res_existing_vitals['date'];
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php if($date_vitals) echo \Application\Model\ApplicationTable::fixDate($date_vitals,$date_format, 'yyyy-mm-dd'); ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Weight'); ?></td>
            <td><?php echo $res_existing_vitals['weight'];?></td>
            <td><?php echo $this->listenerObject->z_xlt('Height'); ?></td>
            <td><?php echo $res_existing_vitals['height']; ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Respiraion'); ?></td>
            <td><?php echo $res_existing_vitals['respiration']; ?></td>
          </tr>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Pulse'); ?></td>
            <td><?php echo $res_existing_vitals['pulse']; ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Oxygen Saturation'); ?></td>
            <td><?php echo $res_existing_vitals['oxygen_saturation']; ?></td>
            <td><?php echo $this->listenerObject->z_xlt('Temperature'); ?></td>
            <td><?php echo $res_existing_vitals['temperature'];?></td>
            <td><?php echo $this->listenerObject->z_xlt('Head Circ'); ?></td>
            <td><?php echo $res_existing_vitals['head_circ']; ?></td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('BPD'); ?></td>
            <td><?php echo $res_existing_vitals['bpd']; ?></td>
            <td><?php echo $this->listenerObject->z_xlt('BPS'); ?></td>
            <td><?php echo $res_existing_vitals['bps']; ?></td>
            <td colspan="4">&nbsp;</td>
          </tr>
            <?php
        }
        foreach($this->vitals_audit['vital_sign'] as $key => $val){
          if($val['date'] != 0 && $val['date'] != '') {
            $vitals_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val['date'],0);
          }
            ?>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='vital_sign-date[]' value='<?php if($vitals_date) echo $vitals_date; ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Weight'); ?></td>
            <td><input type='text' name='vital_sign-weight[]' value='<?php echo $val['weight'];?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Height'); ?></td>
            <td><input type='text' name='vital_sign-height[]' value='<?php echo $val['height']; ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Respiraion'); ?></td>
            <td><input type='text' name='vital_sign-resp[]' value='<?php echo $val['respiration']; ?>' ></td>
          </tr>
          <tr style="border-bottom: 0px">
            <td><?php echo $this->listenerObject->z_xlt('Pulse'); ?></td>
            <td><input type='text' name='vital_sign-pulse[]' value='<?php echo $val['pulse']; ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Oxygen Saturation'); ?></td>
            <td><input type='text' name='vital_sign-oxy_sat[]' value='<?php echo $val['oxygen_saturation']; ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Temperature'); ?></td>
            <td><input type='text' name='vital_sign-temp[]' value='<?php echo $val['temperature'];?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('Head Circ'); ?></td>
            <td><input type='text' name='vital_sign-head_circ[]' value='<?php echo $val['head_circ']; ?>' ></td>
          </tr>
          <tr>
            <td><?php echo $this->listenerObject->z_xlt('BPD'); ?></td>
            <td><input type='text' name='vital_sign-bpd[]' value='<?php echo $val['bpd']; ?>' ></td>
            <td><?php echo $this->listenerObject->z_xlt('BPS'); ?></td>
            <td><input type='text' name='vital_sign-bps[]' value='<?php echo $val['bps']; ?>' ></td>
            <td colspan="4">
              <select name='vital_sign-sel[]'>
                  <option value='ignore' ><?php echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                  <option value='insert' ><?php echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
            <input type="hidden" name="vital_sign-extension[]" value="<?php echo $val['extension'];?>">
          </tr>
            <?php
        }
          ?>
      </table>
<!--            <br/>
      <table class="responsive">
        <tr class="se_in_9">
          <th colspan="9"><?php // echo $this->listenerObject->z_xlt('Procedure'); ?></th>
        </tr>
          <?php
//        foreach($this->procedure as $res_existing_procedure){
            ?>
          <tr>
            <td><?php // echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><?php // echo \Application\Model\ApplicationTable::fixDate($res_existing_procedure['date'], $date_format, 'yyyy-mm-dd');?></td>
            <td><?php // echo $this->listenerObject->z_xlt('Code'); ?></td>
            <td><?php // echo $res_existing_procedure['code']; ?></td>
            <td><?php // echo $this->listenerObject->z_xlt('Code Text'); ?></td>
            <td><?php // echo $res_existing_procedure['code_text']; ?></td>
            <td>&nbsp;</td>
          </tr>
            <?php
        //}
//        foreach($this->procedure_audit['procedure']  as $key => $val){
//          if($val['date'] != 0) {
//            $procedure_date = \Carecoordination\Model\CarecoordinationTable::formatDate($val['date'],0);
          //}
//           $code_text = preg_replace('/^[0-9]+\-/', '', $val['code_text']);
            ?>
          <tr>
            <td><?php // echo $this->listenerObject->z_xlt('Date'); ?></td>
            <td><input type='text' name='procedure-date[]' value='<?php // if($procedure_date) echo $procedure_date;?>' ></td>
            <td><?php // echo $this->listenerObject->z_xlt('Code'); ?></td>
            <td><input type='text' name='procedure-code[]' value='<?php // echo $val['code']; ?>' ></td>
            <td><?php // echo $this->listenerObject->z_xlt('Code Text'); ?></td>
            <td><input type='text' name='procedure-code_text[]' style="width: 100% !important;" value='<?php // echo $code_text; ?>' ></td>
            <td>
              <select name='procedure-sel[]'>
                <option value='ignore' ><?php // echo $this->listenerObject->z_xlt('Ignore'); ?></option>
                <option value='insert' ><?php // echo $this->listenerObject->z_xlt('Insert'); ?></option>
              </select>
            </td>
            <input type="hidden" name="procedure-extension[]" value="<?php // echo $val['extension'];?>">
            <input type="hidden" name="procedure-provider_npi[]" value="<?php // echo $val['provider_npi'];?>">
            <input type="hidden" name="procedure-provider_name[]" value="<?php // echo $val['provider_name'];?>">
            <input type="hidden" name="procedure-provider_address[]" value="<?php // echo $val['provider_address'];?>">
            <input type="hidden" name="procedure-provider_city[]" value="<?php // echo $val['provider_city'];?>">
            <input type="hidden" name="procedure-provider_state[]" value="<?php // echo $val['provider_state'];?>">
            <input type="hidden" name="procedure-provider_postalCode[]" value="<?php // echo $val['provider_postalCode'];?>">
            <input type="hidden" name="procedure-represented_organization[]" value="<?php // echo $val['represented_organization'];?>">
            <input type="hidden" name="procedure-provider_telecom[]" value="<?php // echo $val['provider_telecom'];?>">
          </tr>
            <?php
        //}
          ?>
      </table>-->
    </div>
  </div>
</form>
